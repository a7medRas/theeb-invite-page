<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø¹ÙˆØ© - Ø­Ø¯Ø« Ø®Ø§Øµ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #f6f7fb;
      --card: #fff;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #a67c52;         /* Ø°Ù‡Ø¨ÙŠ */
      --accent-dark: #8c6b44;
      --ok: #1b5e20;
      --border: #e5e7eb;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius-lg: 22px;
      --radius-md: 14px;

      --bar-bg:#fff;
      --bar-text:#111;
      --coin:#f2c94c;
      --coin-shadow:rgba(0,0,0,.15);
    }
    /* ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ */
    body.dark{
      --bg:#0f172a;
      --card:#0b1224;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --accent:#d6a65c;
      --accent-dark:#b1843f;
      --ok:#34d399;
      --border:#1e293b;
      --bar-bg:#0b1224;
      --bar-text:#e5e7eb;
      --coin:#ffd166;
      --coin-shadow:rgba(255,209,102,.25);
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html,body{min-height:100%;font-family:'Cairo',sans-serif;background:var(--bg);color:var(--text)}
    body{display:flex;align-items:flex-start;justify-content:center}
    .wrap{width:min(1040px,94%); margin:18px auto 100px;}

    /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ø¯Ø§Ø¯ + ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
    .topbar{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      background:var(--bar-bg); border:1px solid var(--border);
      border-radius:16px; box-shadow:var(--shadow); padding:10px 14px; margin-bottom:16px;
      position:sticky; top:10px; z-index:5;
    }
    .counter{
      display:flex; align-items:center; gap:10px;
    }
    .coin{
      width:34px;height:34px;border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #fff7d1, var(--coin));
      box-shadow:0 4px 10px var(--coin-shadow);
      animation:spin 2s linear infinite;
    }
    @keyframes spin{ 0%{transform:rotateY(0)} 50%{transform:rotateY(180deg)} 100%{transform:rotateY(360deg)} }
    .amount{font-size:20px;font-weight:800;color:var(--bar-text)}
    .amount small{font-weight:600;color:var(--muted);margin-inline-start:6px}
    .toggle{
      display:flex; align-items:center; gap:8px;
    }
    .toggle button{
      background:var(--accent); color:#fff; border:none; border-radius:999px; padding:8px 12px; cursor:pointer;
    }

    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:var(--radius-lg); box-shadow:var(--shadow);
      padding:24px 20px; margin-top:8px;
    }

    .h1{font-size:clamp(22px,3.2vw,30px); font-weight:800; text-align:center; margin-bottom:10px;}
    .lead{text-align:center; color:var(--muted); line-height:1.9; font-size:clamp(14px,2.2vw,16px); margin-bottom:18px;}
    .subhead{text-align:center; font-weight:700; margin:8px 0 12px; color:var(--text);}

    /* Ø¬Ø¯ÙˆÙ„ */
    table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:14px; margin:10px 0 18px; border:1px solid var(--border)}
    th,td{padding:12px 12px; border-bottom:1px solid var(--border)}
    th{background:var(--accent); color:#fff; font-weight:700}
    tr:last-child td{border-bottom:none}
    td{background:var(--card); color:var(--text)}

    /* Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ²Ø± */
    .field{display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; margin-top:6px}
    .input{flex:1 1 340px; max-width:520px; padding:14px 16px; border:1px solid var(--border); border-radius:999px; background:#fff; font-size:18px; text-align:center; color:#111;}
    body.dark .input{background:#0f172a;color:#e5e7eb;border-color:#1e293b}
    .input::placeholder{color:#9ca3af}
    .btn{padding:12px 20px; border:none; border-radius:999px; cursor:pointer; background:var(--accent); color:#fff; font-size:16px; font-weight:700; transition:filter .15s ease;}
    .btn:hover{filter:brightness(1.05)}
    .btn[disabled]{opacity:.6; cursor:not-allowed}
    .hint{font-size:13px; color:var(--muted); text-align:center; margin-top:8px}
    .cooldown{font-size:13px; color:var(--accent-dark); text-align:center; margin-top:6px; display:none}

    /* ÙƒØ§Ø±Øª Ø§Ù„Ø¯Ø¹ÙˆØ© */
    #inviteCard{display:none; margin-top:18px; background:#faf8f4; border:1px solid #eadfce; border-radius:18px; padding:18px 16px; box-shadow:0 8px 22px rgba(0,0,0,.06)}
    body.dark #inviteCard{background:#111827;border-color:#283145}
    .code{font-size:24px; font-weight:800; color:var(--ok); direction:ltr; text-align:center; margin-bottom:10px}
    .row{display:flex; align-items:center; gap:14px; flex-wrap:wrap; justify-content:center}
    .qr-box{background:#fff; border:1px solid #e9e2d8; border-radius:14px; padding:12px; width:180px;height:180px; display:flex; align-items:center; justify-content:center}
    body.dark .qr-box{background:#0f172a;border-color:#1e293b}
    .preview{flex:1; min-width:260px; display:flex; flex-direction:column; gap:10px; max-width:520px}
    .preview-link{background:#fff; border:1px dashed #d6c7b6; border-radius:12px; padding:12px 10px; color:#111; font-size:14px; line-height:1.6; word-break:break-all; direction:ltr}
    body.dark .preview-link{background:#0f172a;border-color:#374151;color:#e5e7eb}
    .tools .mini, .share .mini{background:#5e5e5e; color:#fff; border:none; border-radius:10px; padding:9px 14px; font-size:14px; cursor:pointer}
    .tools .mini:hover, .share .mini:hover{filter:brightness(1.08)}
    .tools .mini.primary{background:var(--accent)}
    #shareCounter{color:var(--muted); font-size:14px; text-align:center; margin-top:8px}

    /* Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
    .sec-title{text-align:center; font-weight:800; font-size:clamp(18px,2.6vw,22px); margin:18px 0 10px; color:var(--text);}

    /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù†Ø³Ø¨ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© */
    .bonus table th, .bonus table td{text-align:center;}
    .bonus tbody tr td:last-child {font-weight: 800; border-radius: 6px;}
    .bonus tbody tr:nth-child(1) td:last-child {background: #e8f5e9; color: #2e7d32;}
    .bonus tbody tr:nth-child(2) td:last-child {background: #e3f2fd; color: #1565c0;}
    .bonus tbody tr:nth-child(3) td:last-child {background: #fff3e0; color: #ef6c00;}
    .bonus tbody tr:nth-child(4) td:last-child {background: #f3e5f5; color: #6a1b9a;}
    .bonus tbody tr:nth-child(5) td:last-child {background: #fff8e1; color: #b28900;}

    /* ===== Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ===== */
    .sim{
      margin-top:26px; background:var(--card); border:1px solid var(--border);
      border-radius:18px; padding:18px 16px;
    }
    .sim .controls{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-bottom:10px}
    .sim .input{flex:1 1 220px; max-width:280px}
    .sim .grid{
      display:grid; grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px; margin-top:10px
    }
    .stat{
      background:#fafafa; border:1px dashed #e5e7eb; border-radius:12px; padding:10px;
      text-align:center; font-size:14px; color:#111;
    }
    body.dark .stat{background:#0f172a;border-color:#334155;color:#e5e7eb}
    .stat b{display:block; font-size:18px; margin-top:6px}
    .chart-wrap{margin-top:14px; background:var(--card); border:1px solid var(--border); border-radius:14px; padding:10px}

    /* ===== Modal Ø§Ù„Ø¨ÙˆØ³ØªØ± ===== */
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.45); z-index:20}
    .modal .box{background:var(--card); border-radius:16px; padding:14px; width:min(900px,95%); border:1px solid var(--border)}
    .modal .head{display:flex; justify-content:space-between; align-items:center; margin-bottom:8px}
    .modal .head h4{margin:0; font-size:18px}
    .modal .btns{display:flex; gap:8px}
    .x{background:#e11d48; color:#fff; border:none; border-radius:10px; padding:8px 12px; cursor:pointer}
    .ghost{background:#5e5e5e; color:#fff; border:none; border-radius:10px; padding:8px 12px; cursor:pointer}
    .gold{background:var(--accent); color:#fff; border:none; border-radius:10px; padding:8px 12px; cursor:pointer}
    .poster-wrap{display:flex; justify-content:center; align-items:center; padding:6px}
    canvas.poster{width:100%; height:auto; background:#fff; border-radius:10px}

    /* Toast */
    .toast{position:fixed; top:16px; right:16px; background:#111c; color:#fff; padding:10px 14px; border-radius:12px; font-size:14px; opacity:0; transform:translateY(-8px); transition:all .25s ease; z-index:30}
    .toast.show{opacity:1; transform:translateY(0)}

    /* Ø¥Ù†Ø¬Ø§Ø²Ø§Øª */
    .achv{margin-top:18px; background:var(--card); border:1px dashed var(--border); border-radius:16px; padding:14px}
    .achv-list{display:grid; grid-template-columns:repeat(auto-fit,minmax(190px,1fr)); gap:10px}
    .badge{
      display:flex; align-items:center; gap:10px; border:1px solid var(--border); border-radius:12px; padding:10px; background:rgba(166,124,82,.06)
    }
    .badge.lock{opacity:.6; filter:grayscale(1)}
    .badge .emoji{font-size:20px}
    .badge .t{font-size:14px}
    .badge .t small{display:block;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- TOP BAR: Ø§Ù„Ø¹Ø¯Ø§Ø¯ + ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ -->
    <div class="topbar">
      <div class="counter">
        <div class="coin" aria-hidden="true"></div>
        <div class="amount" id="liveAmount">0 <small>USD</small></div>
      </div>
      <div class="toggle">
        <span style="color:var(--muted)">Ø§Ù„ÙˆØ¶Ø¹</span>
        <button id="darkToggle">ğŸŒ™/â˜€ï¸ ØªØ¨Ø¯ÙŠÙ„</button>
      </div>
    </div>

    <div class="card">
      <h1 class="h1">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ğŸ‰</h1>
      <p class="lead">
        Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯Ø« Ù…ØªØ§Ø­ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ø°ÙŠØ¹ÙŠÙ† Ø§Ù„ÙˆÙƒØ§Ù„Ø©. ÙŠÙ…ÙƒÙ† Ù„ÙƒÙ„ Ù…Ø°ÙŠØ¹ Ø§Ù„Ø­ØµÙˆÙ„
        Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø¯Ø¹ÙˆØ© Ø®Ø§ØµØ© Ø¨Ù‡ ÙˆØ¯Ø¹ÙˆØ© Ø£Ø´Ø®Ø§Øµ Ø¬Ø¯Ø¯ ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ¢Øª ØªØµÙ„
        Ø¥Ù„Ù‰ <b>$1000</b> Ø´Ù‡Ø±ÙŠÙ‹Ø§.
      </p>
      <div class="subhead">Ø´Ø±ÙˆØ· Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©:</div>
      <p class="lead" style="margin-top:-4px">
        1- Ø£Ù† ÙŠØ¬ØªØ§Ø² Ø§Ù„Ù…Ø°ÙŠØ¹ Ø§Ù„Ù…Ø¯Ø¹Ùˆ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆØ¯ÙŠØ´Ù†. <br>
        2- Ø£Ù† ÙŠØ­Ù‚Ù‚ 31 Ø³Ø§Ø¹Ø© Ø®Ù„Ø§Ù„ Ø£ÙˆÙ„ Ø´Ù‡Ø±.
      </p>

      <!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ -->
      <table aria-label="Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª">
        <thead><tr><th>Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø¹ÙˆØ©</th><th>Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©</th></tr></thead>
        <tbody>
          <tr><td>Ù…Ø°ÙŠØ¹ Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·</td><td>2$</td></tr>
          <tr><td>Ù…Ø°ÙŠØ¹ Ù…Ù† Ø¯ÙˆÙ„ Ø§Ù„Ø®Ù„ÙŠØ¬</td><td>4$</td></tr>
        </tbody>
      </table>

      <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© -->
      <section class="bonus">
        <h3 class="sec-title">Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© â€“ Ù†Ø³Ø¨Ø© Ù…Ù† ØªØ§Ø±Ø¬ÙŠØª Ø§Ù„Ù…Ø¯Ø¹Ùˆ</h3>
        <p class="lead" style="margin-top:-4px; text-align:center">
          ÙŠØ­ØµÙ„ Ø§Ù„Ø¯Ø§Ø¹ÙŠ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ£Ø© Ù„Ù…Ø¯Ø© <b>3 Ø´Ù‡ÙˆØ± Ù…ØªØªØ§Ù„ÙŠØ©</b> ÙÙŠ Ø­Ø§Ù„ Ù‚Ø§Ù… Ø§Ù„Ù…Ø°ÙŠØ¹ Ø§Ù„Ù…Ø¯Ø¹Ùˆ
          Ø¨ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªØ§Ø±Ø¬ÙŠØª Ø¨Ù†ÙØ³Ù‡ØŒ ØªØµÙ„ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø¥Ù„Ù‰ <b>25%</b>.
        </p>
        <table aria-label="Ø¬Ø¯ÙˆÙ„ Ù†Ø³Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©">
          <thead><tr><th>Ø´Ø±ÙŠØ­Ø© Ø§Ù„ØªØ§Ø±Ø¬ÙŠØª (USD)</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ù„Ù„Ø¯Ø§Ø¹ÙŠ</th></tr></thead>
          <tbody>
            <tr><td>Ù…Ù† 2,000 Ø¥Ù„Ù‰ 50,000</td><td>2%</td></tr>
            <tr><td>Ù…Ù† 80,000 Ø¥Ù„Ù‰ 220,000</td><td>8%</td></tr>
            <tr><td>Ù…Ù† 300,000 Ø¥Ù„Ù‰ 800,000</td><td>15%</td></tr>
            <tr><td>Ù…Ù† 1,000,000 Ø¥Ù„Ù‰ 5,000,000</td><td>20%</td></tr>
            <tr><td>Ù…Ù† 6,500,000 Ø¥Ù„Ù‰ 10,000,000</td><td>25%</td></tr>
          </tbody>
        </table>
        <p class="hint">* ØªÙØ­ØªØ³Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø±Ø¬ÙŠØª Ø§Ù„Ø´Ù‡Ø±ÙŠØŒ ÙˆØªØµØ±Ù Ù„Ù…Ø¯Ø© 3 Ø´Ù‡ÙˆØ± Ù…ØªØªØ§Ù„ÙŠØ© Ø·Ø§Ù„Ù…Ø§ Ø§Ø³ØªÙˆÙÙ‰ Ø§Ù„Ù…Ø¯Ø¹Ùˆ Ø§Ù„Ø´Ø±ÙˆØ·.</p>
      </section>

      <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
      <div class="field">
        <input id="likeeId" class="input" placeholder="Ø§ÙƒØªØ¨ Likee ID â€” Ø­Ø±ÙˆÙ ÙˆØ£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø· (3 Ø±Ù…ÙˆØ²+)" inputmode="latin" autocomplete="off" />
        <button id="genBtn" class="btn" onclick="generateCode()">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯</button>
      </div>
      <p class="hint">Ø£Ù…Ø«Ù„Ø© ØµØ§Ù„Ø­Ø©: <span dir="ltr">adam123</span> â€¢ <span dir="ltr">L1K33Star9</span></p>
      <div id="cooldownHint" class="cooldown"></div>

      <!-- ÙƒØ§Ø±Øª Ø§Ù„Ø¯Ø¹ÙˆØ© -->
      <section id="inviteCard" aria-live="polite">
        <div class="code" id="inviteCode"></div>
        <div class="row" style="margin-bottom:8px">
          <div class="qr-box"><img id="qrImg" alt="QR" width="160" height="160" /></div>
          <div class="preview">
            <div id="inviteLinkPreview" class="preview-link"></div>
            <div class="row tools">
              <button class="mini primary" onclick="copyCode()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
              <button class="mini primary" onclick="copyLink()">ğŸ”— Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
              <button class="mini" onclick="downloadCard()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØ§Ø±Øª PNG</button>
              <button class="mini" onclick="openPoster()">ğŸ–¼ï¸ Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØ³ØªØ±</button>
            </div>
          </div>
        </div>
        <div class="row share">
          <button class="mini" onclick="share('whatsapp')">ÙˆØ§ØªØ³Ø§Ø¨</button>
          <button class="mini" onclick="share('telegram')">ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</button>
          <button class="mini" onclick="share('messenger')">Ù…Ø§Ø³Ù†Ø¬Ø±</button>
          <button class="mini" onclick="share('copy')">Ù†Ø³Ø® Ø§Ù„Ù†Øµ</button>
        </div>
        <p id="shareCounter"></p>
      </section>

      <!-- Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ -->
      <section class="sim" id="sim">
        <h3 class="sec-title">Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ</h3>
        <div class="controls">
          <input id="simCount" class="input" type="number" min="1" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ† (Ù…Ø«Ø§Ù„: 5)" />
          <input id="simTarget" class="input" type="number" min="0" step="100" placeholder="Ù…ØªÙˆØ³Ø· Ø§Ù„ØªØ§Ø±Ø¬ÙŠØª Ù„ÙƒÙ„ Ù…Ø¯Ø¹Ùˆ (USD)" />
          <button class="btn" onclick="runSimulator(true)">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¢Ù†</button>
        </div>
        <p class="hint">* Ø­Ø³Ø§Ø¨ ØªÙ‚Ø±ÙŠØ¨ÙŠ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙˆÙŠÙØªØ±Ø¶ Ø£Ù† ÙƒÙ„ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ† ÙŠØ­Ù‚Ù‚ÙˆÙ† Ù†ÙØ³ Ø§Ù„Ù…ØªÙˆØ³Ø·.</p>
        <div class="grid">
          <div class="stat">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© <b id="simPercent">â€”</b></div>
          <div class="stat">Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ <b id="simMonthly">â€”</b></div>
          <div class="stat">Ø¥Ø¬Ù…Ø§Ù„ÙŠ 3 Ø´Ù‡ÙˆØ± <b id="simQuarter">â€”</b></div>
          <div class="stat">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ† Ã— Ø§Ù„Ù…ØªÙˆØ³Ø· <b id="simVolume">â€”</b></div>
        </div>
        <div class="chart-wrap">
          <canvas id="earnChart" height="140" aria-label="Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø£Ø±Ø¨Ø§Ø­"></canvas>
        </div>
      </section>

      <!-- Ø¥Ù†Ø¬Ø§Ø²Ø§Øª -->
      <section class="achv">
        <h3 class="sec-title">Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h3>
        <div class="achv-list" id="achvList">
          <div class="badge lock" data-key="first_code"><div class="emoji">ğŸ¯</div><div class="t">Ø£ÙˆÙ„ ÙƒÙˆØ¯<div><small>ÙˆÙ„Ù‘Ø¯ Ø£ÙˆÙ„ ÙƒÙˆØ¯ Ø¯Ø¹ÙˆØ©</small></div></div></div>
          <div class="badge lock" data-key="ten_codes"><div class="emoji">ğŸ’ª</div><div class="t">10 Ø£ÙƒÙˆØ§Ø¯<div><small>ÙˆÙ„Ù‘Ø¯ 10 Ø£ÙƒÙˆØ§Ø¯ Ø¯Ø¹ÙˆØ©</small></div></div></div>
          <div class="badge lock" data-key="sim_used"><div class="emoji">ğŸ“Š</div><div class="t">Ø£ÙˆÙ„ Ù…Ø­Ø§ÙƒØ§Ø©<div><small>Ø´ØºÙ‘Ù„ Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</small></div></div></div>
        </div>
      </section>
    </div>

    <!-- Poster Modal -->
    <div class="modal" id="posterModal" role="dialog" aria-modal="true" aria-labelledby="posterTitle">
      <div class="box">
        <div class="head">
          <h4 id="posterTitle">Ø¨ÙˆØ³ØªØ± Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø´Ø®ØµÙŠ (1080Ã—1080)</h4>
          <div class="btns">
            <button class="ghost" onclick="regenPoster()">ØªØ­Ø¯ÙŠØ«</button>
            <button class="gold" onclick="downloadPoster()">ØªÙ†Ø²ÙŠÙ„ PNG</button>
            <button class="x" onclick="closePoster()">Ø¥ØºÙ„Ø§Ù‚</button>
          </div>
        </div>
        <div class="poster-wrap">
          <canvas id="posterCanvas" class="poster" width="1080" height="1080"></canvas>
        </div>
      </div>
    </div>

    <!-- Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù†Ø¬Ø§Ø­ -->
    <div class="card" style="margin-top:16px">
      <h3 class="sec-title">ğŸ“š Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„Ø³Ø±ÙŠØ¹</h3>
      <ul style="line-height:2; color:var(--muted); font-size:15px; padding-inline:18px">
        <li>Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ù‚ØµÙŠØ±Ø© ÙˆÙˆØ§Ø¶Ø­Ø© Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ ÙˆØ­Ø·Ù‘ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø£ÙˆÙ„ Ø§Ù„Ø³Ø·Ø±.</li>
        <li>Ø§Ù†Ø´Ø± Ø§Ù„Ø¨ÙˆØ³ØªØ± ÙÙŠ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ© (8â€“10Ù…) ÙˆØ§Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø¯Ø¹Ùˆ Ø­ÙØ¸Ù‡.</li>
        <li>Ø°ÙƒÙ‘Ø± Ø§Ù„Ù…Ø¯Ø¹Ùˆ Ø¨ØªØ­Ù‚ÙŠÙ‚ Ø´Ø±ÙˆØ· Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© (Ø§Ù„Ø£ÙˆØ¯ÙŠØ´Ù† + 31 Ø³Ø§Ø¹Ø©).</li>
        <li>Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù„ØªØ­Ø¯ÙŠØ¯ Ù‡Ø¯Ù Ø´Ù‡Ø±ÙŠ ÙˆØ§Ù‚Ø¹ÙŠ Ù„Ùƒ ÙˆÙ„ÙØ±ÙŠÙ‚Ùƒ.</li>
      </ul>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Ù…ÙƒØªØ¨Ø§Øª -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <script>
    const $ = s => document.querySelector(s);
    const liveAmountEl = $("#liveAmount");
    const darkToggle = $("#darkToggle");
    const likeeInput = $("#likeeId");
    const genBtn = $("#genBtn");
    const inviteCard = $("#inviteCard");
    const codeArea = $("#inviteCode");
    const linkPreview = $("#inviteLinkPreview");
    const qrImg = $("#qrImg");
    const cooldownHint = $("#cooldownHint");
    const toastEl = $("#toast");

    // Simulator elements
    const simCount = $("#simCount");
    const simTarget = $("#simTarget");
    const simPercent = $("#simPercent");
    const simMonthly = $("#simMonthly");
    const simQuarter = $("#simQuarter");
    const simVolume = $("#simVolume");
    let earnChart;

    // Poster elements
    const posterModal = $("#posterModal");
    const posterCanvas = $("#posterCanvas");
    const pctx = posterCanvas.getContext("2d");

    // Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
    const achvList = $("#achvList");

    let counter = 0;          // Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
    let lastGenTime = 0;
    const COOLDOWN = 5;
    let liveEarnings = 0;     // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø©

    /* ====== ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ ====== */
    (function initTheme(){
      const saved = localStorage.getItem('theme') || 'light';
      if(saved === 'dark') document.body.classList.add('dark');
      darkToggle.onclick = ()=>{
        document.body.classList.toggle('dark');
        localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
      };
    })();

    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      setTimeout(()=>toastEl.classList.remove('show'), 1700);
    }

    // Ø¥Ø¯Ø®Ø§Ù„ Likee: Ø­Ø±ÙˆÙ/Ø£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·
    likeeInput.addEventListener('input', () => {
      const cleaned = (likeeInput.value || '')
        .replace(/\s+/g,'')
        .replace(/[^A-Za-z0-9]/g,'');
      if(cleaned !== likeeInput.value) likeeInput.value = cleaned;
    });

    (function init(){
      try{
        const saved = localStorage.getItem('likeeId');
        if(saved) likeeInput.value = saved;
      }catch(e){}
      const p = new URLSearchParams(location.search);
      const urlCode = p.get('code');
      if(urlCode) showResult(urlCode);

      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø£Ø±Ø¨Ø§Ø­ Ø­ÙŠØ© Ù…Ø­ÙÙˆØ¸Ø©
      const savedAmount = parseFloat(localStorage.getItem('liveEarnings') || '0');
      if(savedAmount>0){ liveEarnings = savedAmount; renderAmount(); }

      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
      refreshAchievementsUI();

      // Init empty chart
      buildChart([0,0,0,0], ['Ø´Ù‡Ø± 1','Ø´Ù‡Ø± 2','Ø´Ù‡Ø± 3','Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ']);
    })();

    function validateId(id){ return /^[A-Za-z0-9]{3,}$/.test(id); }
    function rand4(){ return Math.floor(1000 + Math.random()*9000); }
    function inviteLink(inviteCode){ const base = location.origin + location.pathname; return base + '?code=' + encodeURIComponent(inviteCode); }

    function startCooldown(){
      const start = Date.now();
      genBtn.disabled = true; cooldownHint.style.display = 'block';
      const tick = () => {
        const remain = Math.max(0, COOLDOWN - Math.floor((Date.now()-start)/1000));
        cooldownHint.textContent = 'â³ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ' + remain + ' Ø« Ù‚Ø¨Ù„ ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø¬Ø¯ÙŠØ¯.';
        if(remain <= 0){ genBtn.disabled = false; cooldownHint.style.display = 'none'; }
        else setTimeout(tick, 250);
      }; tick();
    }

    function generateCode(){
      const now = Date.now();
      if(now - lastGenTime < COOLDOWN*1000){ startCooldown(); toast('Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ù‹Ø§â€¦'); return; }
      const id = (likeeInput.value || '').trim();
      if(!validateId(id)){ toast('âŒ Likee ID ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø­Ø±ÙˆÙ/Ø£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø· ÙˆØ¨Ø­Ø¯ Ø£Ø¯Ù†Ù‰ 3 Ø±Ù…ÙˆØ².'); likeeInput.focus(); return; }
      try{ localStorage.setItem('likeeId', id); }catch(e){}
      const code = `TH-${id}-${rand4()}`;
      showResult(code);
      sendToGoogleSheet(id, code);
      lastGenTime = now; startCooldown();

      // Ø¥Ù†Ø¬Ø§Ø²: Ø£ÙˆÙ„ ÙƒÙˆØ¯ + 10 Ø£ÙƒÙˆØ§Ø¯
      unlockAchievement('first_code');
      if(counter >= 10) unlockAchievement('ten_codes');
    }

    function showResult(code){
      codeArea.textContent = code;
      const link = inviteLink(code);
      linkPreview.textContent = link;
      qrImg.src = "https://api.qrserver.com/v1/create-qr-code/?size=170x170&data=" + encodeURIComponent(link);
      qrImg.alt = "QR to " + link;
      inviteCard.style.display = 'block';
      incrementCounter();
    }

    function incrementCounter(){ counter++; $("#shareCounter").innerText = `ğŸ’¡ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§/Ø¹Ø±Ø¶Ù‡Ø§: ${counter}`; }

    function copyText(t){ navigator.clipboard.writeText(t).then(()=>toast('ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…')); }
    function copyCode(){ const c = codeArea.textContent.trim(); if(c) copyText(c); }
    function copyLink(){ const l = linkPreview.textContent.trim(); if(l) copyText(l); }

    function share(platform){
      const c = codeArea.textContent.trim();
      const l = linkPreview.textContent.trim();
      const text = `ğŸ“¢ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø®Ø§Øµ Ø¨ÙŠ: ${c}\nØ§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù† Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯Ø«!\n${l}`;
      let url = "";
      switch(platform){
        case "whatsapp": url = `https://wa.me/?text=${encodeURIComponent(text)}`; break;
        case "telegram": url = `https://t.me/share/url?url=${encodeURIComponent(l)}&text=${encodeURIComponent('Ø§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù†! ' + c)}`; break;
        case "messenger": url = `fb-messenger://share/?link=${encodeURIComponent(l)}&app_id=0`; break;
        case "copy": copyText(text); return;
      }
      window.open(url, '_blank');
    }

    // Ø­ÙØ¸ Ø§Ù„ÙƒØ§Ø±Øª ÙƒØµÙˆØ±Ø©
    async function downloadCard(){
      try{
        const node = document.getElementById('inviteCard');
        const canvas = await html2canvas(node, {scale:2, useCORS:true});
        const dataURL = canvas.toDataURL('image/png');
        const a = document.createElement('a');
        const name = (codeArea.textContent || 'invite').replace(/\s+/g,'');
        a.href = dataURL; a.download = name + '.png'; a.click();
      }catch(e){ toast('ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§'); }
    }

    function sendToGoogleSheet(likeeId, inviteCode) {
      fetch("https://script.google.com/macros/s/AKfycbwtnLPgvBZJ35GlA75TejT4eQVNPQaWRmBD2r4YvRqNCwY91HF3AXiPn4udTANT4zwv/exec", {
        method: "POST",
        body: new URLSearchParams({ likeeId, inviteCode })
      }).then(r=>r.text()).catch(()=>{});
    }

    /* ===================== Earnings Simulator ===================== */
    function getPercentByTarget(t){
      if(t >= 6500000 && t <= 10000000) return 0.25;
      if(t >= 1000000 && t <= 5000000)  return 0.20;
      if(t >= 300000 && t <= 800000)    return 0.15;
      if(t >= 80000  && t <= 220000)    return 0.08;
      if(t >= 2000   && t <= 50000)     return 0.02;
      return 0; // Ø®Ø§Ø±Ø¬ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
    }

    function fmtUSD(n){
      try{
        return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0}).format(n||0);
      }catch(e){ return (n||0).toLocaleString() + ' $'; }
    }

    // addToCounterOnRun: Ù„Ù…Ø§ true ÙŠØ¶ÙŠÙ Ø§Ù„Ù†Ø§ØªØ¬ Ù„Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
    function runSimulator(addToCounterOnRun=false){
      const count = Math.max(0, parseInt(simCount.value || '0', 10));
      const target = Math.max(0, parseFloat(simTarget.value || '0'));
      if(!count || !target){
        simPercent.textContent='â€”'; simMonthly.textContent='â€”'; simQuarter.textContent='â€”'; simVolume.textContent='â€”';
        buildChart([0,0,0,0]); return;
      }

      const pct = getPercentByTarget(target);
      const monthly = count * target * pct;
      const quarter = monthly * 3;
      const volume  = count * target;

      simPercent.textContent = pct ? (pct*100).toFixed(0) + '%' : 'Ø®Ø§Ø±Ø¬ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­';
      simMonthly.textContent = fmtUSD(monthly);
      simQuarter.textContent = fmtUSD(quarter);
      simVolume.textContent  = fmtUSD(volume);

      buildChart([monthly, monthly, monthly, quarter], ['Ø´Ù‡Ø± 1','Ø´Ù‡Ø± 2','Ø´Ù‡Ø± 3','Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ']);

      // Ø¥Ù†Ø¬Ø§Ø²: Ø£ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­Ø§ÙƒÙŠ
      unlockAchievement('sim_used');

      // ØªØ²Ø§Ù…Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ø¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­ÙŠ (Ù†Ø¶ÙŠÙ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù…Ø±Ù‘Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ Ø­Ø³Ø§Ø¨)
      if(addToCounterOnRun && monthly>0){
        addEarnings(monthly);
      }
    }

    function buildChart(data, labels=['Ø´Ù‡Ø± 1','Ø´Ù‡Ø± 2','Ø´Ù‡Ø± 3','Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ']){
      const ctx = document.getElementById('earnChart');
      if(earnChart){ earnChart.destroy(); }
      earnChart = new Chart(ctx, {
        type: 'bar',
        data: { labels, datasets: [{ label: 'Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ (USD)', data }] },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true, ticks: { callback: v => fmtUSD(v).replace('$','') + ' $' } } }
        }
      });
    }

    /* ===================== Live Earnings Counter ===================== */
    function renderAmount(){
      liveAmountEl.innerHTML = Math.round(liveEarnings).toLocaleString('en-US') + ' <small>USD</small>';
    }
    function animateTo(target){
      const start = liveEarnings;
      const diff = target - start;
      const dur = 800; // ms
      const t0 = performance.now();
      function step(t){
        const p = Math.min(1, (t - t0)/dur);
        liveEarnings = start + diff * (0.5 - Math.cos(Math.PI*p)/2); // ease-in-out
        renderAmount();
        if(p<1) requestAnimationFrame(step);
        else { localStorage.setItem('liveEarnings', String(liveEarnings)); }
      }
      requestAnimationFrame(step);
    }
    function addEarnings(amount){
      if(!amount || amount<=0) return;
      animateTo(liveEarnings + amount);
      // Ù†Ø¨Ø¶Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø©
      const coin = document.querySelector('.coin');
      coin.style.transform = 'scale(1.25)';
      setTimeout(()=>coin.style.transform='', 220);
    }

    /* ===================== Poster Generator (1080x1080) ===================== */
    function openPoster(){
      if(!codeArea.textContent.trim()){ toast('ÙˆÙ„Ù‘Ø¯ Ø§Ù„ÙƒÙˆØ¯ Ø£ÙˆÙ„Ù‹Ø§'); return; }
      posterModal.style.display = 'grid';
      regenPoster();
    }
    function closePoster(){ posterModal.style.display = 'none'; }
    function regenPoster(){
      const code = codeArea.textContent.trim();
      const link = linkPreview.textContent.trim();
      const id   = (likeeInput.value || '').trim();
      drawPoster({code, link, id});
    }
    function downloadPoster(){
      const a = document.createElement('a');
      a.href = posterCanvas.toDataURL('image/png');
      a.download = (codeArea.textContent.trim() || 'invite') + '-poster.png';
      a.click();
    }

    function drawPoster({code, link, id}){
      const w = posterCanvas.width, h = posterCanvas.height;
      // Ø®Ù„ÙÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©: Gradient + Ø­Ù„Ù‚Ø§Øª Ø´ÙØ§ÙØ©
      const g = pctx.createLinearGradient(0,0,w,h);
      g.addColorStop(0,'#1f2937'); g.addColorStop(0.6,'#2b3545'); g.addColorStop(1,'#3c3f4a');
      pctx.fillStyle = g; pctx.fillRect(0,0,w,h);
      pctx.globalAlpha = 0.08;
      pctx.strokeStyle = '#fff'; pctx.lineWidth = 2;
      for(let r=520; r>60; r-=50){ pctx.beginPath(); pctx.arc(w/2, h/2, r, 0, Math.PI*2); pctx.stroke(); }
      pctx.globalAlpha = 1;

      // Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ Ø°Ù‡Ø¨ÙŠ
      pctx.fillStyle = '#a67c52'; pctx.fillRect(0,0,w,110);
      pctx.fillStyle = '#fff'; pctx.font = 'bold 46px Cairo'; pctx.textAlign = 'center';
      pctx.fillText('Ø¯Ø¹ÙˆØªÙƒ Ø§Ù„Ø®Ø§ØµÙ‘Ø©', w/2, 72);

      // Ø¨Ø·Ø§Ù‚Ø© ÙˆØ³Ø·
      const cardSize = w - 200; // 880
      const cardX = (w - cardSize)/2, cardY = 150;
      pctx.fillStyle = '#ffffff';
      roundRect(pctx, cardX, cardY, cardSize, cardSize - 80, 28, true, false);

      // Ø§Ù„ÙƒÙˆØ¯
      pctx.fillStyle = '#1b5e20'; pctx.font = '700 62px Cairo'; pctx.textAlign = 'center';
      pctx.fillText(code || 'TH-XXXX-1234', w/2, cardY + 115);

      // Likee ID
      pctx.fillStyle = '#4b5563'; pctx.font = '600 30px Cairo';
      pctx.fillText(id ? ('Likee ID: ' + id) : 'Likee ID', w/2, cardY + 165);

      // QR
      const qrSize = 360, qrX = w/2 - qrSize/2, qrY = cardY + 210;
      const qr = new Image(); qr.crossOrigin = 'anonymous';
      qr.onload = ()=>{
        pctx.drawImage(qr, qrX, qrY, qrSize, qrSize);
        // Ø§Ù„Ø±Ø§Ø¨Ø·
        pctx.fillStyle = '#111'; pctx.font = '600 26px Cairo';
        wrapText(pctx, link || 'https://your-link', w/2, qrY + qrSize + 50, cardSize - 160, 34);
        // Ø¹Ø¨Ø§Ø±Ø©
        pctx.fillStyle = '#6b7280'; pctx.font = '600 26px Cairo';
        pctx.fillText('Ø´Ø§Ø±Ùƒ Ø§Ù„ÙƒÙˆØ¯ ÙˆØ§Ù„Ø±Ø§Ø¨Ø· â€“ Ø£Ø±Ø¨Ø§Ø­Ùƒ ØªØ¨Ø¯Ø£ Ù…Ù† Ù‡Ù†Ø§ âœ¨', w/2, cardY + cardSize - 42);
      };
      qr.src = "https://api.qrserver.com/v1/create-qr-code/?size="+qrSize+"x"+qrSize+"&data=" + encodeURIComponent(link || code || '');
    }

    function roundRect(ctx, x, y, w, h, r, fill=true, stroke=false){
      ctx.beginPath();
      ctx.moveTo(x+r, y);
      ctx.arcTo(x+w, y, x+w, y+h, r);
      ctx.arcTo(x+w, y+h, x, y+h, r);
      ctx.arcTo(x, y+h, x, y, r);
      ctx.arcTo(x, y, x+w, y, r);
      ctx.closePath();
      if(fill) ctx.fill();
      if(stroke) ctx.stroke();
    }

    function wrapText(ctx, text, centerX, startY, maxWidth, lineHeight){
      const words = (text || '').split(' ');
      let line = '', y = startY;
      ctx.textAlign = 'center';
      for(let n=0;n<words.length;n++){
        const testLine = line + words[n] + ' ';
        const metrics = ctx.measureText(testLine);
        if(metrics.width > maxWidth && n>0){
          ctx.fillText(line.trim(), centerX, y);
          line = words[n] + ' ';
          y += lineHeight;
        }else{
          line = testLine;
        }
      }
      ctx.fillText(line.trim(), centerX, y);
    }

    /* ===================== Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ===================== */
    function refreshAchievementsUI(){
      const keys = ['first_code','ten_codes','sim_used'];
      keys.forEach(k=>{
        const el = achvList.querySelector(`[data-key="${k}"]`);
        const unlocked = localStorage.getItem('achv_'+k) === '1';
        el.classList.toggle('lock', !unlocked);
      });
    }
    function unlockAchievement(key){
      const storageKey = 'achv_'+key;
      if(localStorage.getItem(storageKey) === '1') return;
      localStorage.setItem(storageKey, '1');
      refreshAchievementsUI();
      toast('ğŸ… Ø¥Ù†Ø¬Ø§Ø² Ø¬Ø¯ÙŠØ¯!');
    }

    /* ===================== Live amount formatting ===================== */
    function renderAmount(){
      document.getElementById('liveAmount').innerHTML = Math.round(liveEarnings).toLocaleString('en-US') + ' <small>USD</small>';
    }
    function animateTo(target){
      const start = liveEarnings;
      const diff = target - start;
      const dur = 800; // ms
      const t0 = performance.now();
      function step(t){
        const p = Math.min(1, (t - t0)/dur);
        liveEarnings = start + diff * (0.5 - Math.cos(Math.PI*p)/2); // ease in/out
        renderAmount();
        if(p<1) requestAnimationFrame(step);
        else localStorage.setItem('liveEarnings', String(liveEarnings));
      }
      requestAnimationFrame(step);
    }
    function addEarnings(amount){
      if(!amount || amount<=0) return;
      animateTo(liveEarnings + amount);
      const coin = document.querySelector('.coin');
      coin.style.transform = 'scale(1.25)';
      setTimeout(()=>coin.style.transform='', 220);
    }

    // Ø±Ø¨Ø· Ø²Ø± Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ Ù„ÙŠØ²Ø§Ù…Ù† Ø§Ù„Ø¹Ø¯Ø§Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ (ØªÙ… Ø¨ØªÙ…Ø±ÙŠØ± true ÙÙŠ runSimulator)
    // ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ addEarnings Ù…Ù† Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.

  </script>
</body>
</html>
